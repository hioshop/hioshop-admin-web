(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-62c98acc"],{"14d9":function(e,t,o){"use strict";var r=o("23e7"),n=o("7b0b"),i=o("07fa"),a=o("3a34"),s=o("3511"),l=o("d039"),c=l((function(){return 4294967297!==[].push.call({length:4294967296},1)})),u=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}},m=c||!u();r({target:"Array",proto:!0,arity:1,forced:m},{push:function(e){var t=n(this),o=i(t),r=arguments.length;s(o+r);for(var l=0;l<r;l++)t[o]=arguments[l],o++;return a(t,o),o}})},"1af1":function(e,t,o){"use strict";o("8875")},"3a34":function(e,t,o){"use strict";var r=o("83ab"),n=o("e8b5"),i=TypeError,a=Object.getOwnPropertyDescriptor,s=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=s?function(e,t){if(n(e)&&!a(e,"length").writable)throw i("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},8875:function(e,t,o){},bd29:function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"content-page"},[o("div",{staticClass:"content-nav"},[o("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[o("el-breadcrumb-item",{attrs:{to:{name:"nature"}}},[e._v("商品设置")]),o("el-breadcrumb-item",[e._v(e._s(e.infoForm.id?"编辑分类":"添加分类"))])],1),o("div",{staticClass:"operation-nav"},[o("el-button",{attrs:{type:"primary",icon:"arrow-left"},on:{click:e.goBackPage}},[e._v("返回列表")])],1)],1),o("div",{staticClass:"content-main"},[o("div",{staticClass:"form-table-box"},[o("el-form",{ref:"infoForm",attrs:{rules:e.infoRules,model:e.infoForm,"label-width":"120px"}},[o("el-form-item",{attrs:{label:"分类名称",prop:"name"}},[o("el-input",{model:{value:e.infoForm.name,callback:function(t){e.$set(e.infoForm,"name",t)},expression:"infoForm.name"}})],1),o("el-form-item",{attrs:{label:"简短介绍"}},[o("el-input",{attrs:{type:"textarea",rows:1},model:{value:e.infoForm.front_name,callback:function(t){e.$set(e.infoForm,"front_name",t)},expression:"infoForm.front_name"}}),o("div",{staticClass:"form-tip"})],1),0==e.infoForm.parent_id?o("el-form-item",{attrs:{label:"分类图片",prop:"img_url"}},[e.infoForm.img_url?o("img",{staticClass:"image-show",attrs:{src:e.infoForm.img_url}}):e._e(),o("el-upload",{staticClass:"upload-demo",attrs:{name:"file",action:e.qiniuZone,"on-remove":e.bannerRemove,"before-remove":e.beforeBannerRemove,"file-list":e.fileList,"on-success":e.handleUploadBannerSuccess,data:e.picData,"before-upload":e.getQiniuToken}},[e.infoForm.img_url?e._e():o("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1),o("div",{staticClass:"form-tip"},[e._v(" 图片尺寸：顶级分类为690*自定义, 只能上传jpg/png文件 ")])],1):e._e(),0==e.infoForm.parent_id?o("el-form-item",{attrs:{label:"分类图片高度",prop:"name"}},[o("el-input",{model:{value:e.infoForm.p_height,callback:function(t){e.$set(e.infoForm,"p_height",t)},expression:"infoForm.p_height"}})],1):e._e(),0==e.infoForm.parent_id?o("el-form-item",{attrs:{label:"图标",prop:"icon_url"}},[e.infoForm.icon_url?o("img",{staticClass:"image-show",attrs:{src:e.infoForm.icon_url}}):e._e(),o("el-upload",{staticClass:"upload-demo",attrs:{name:"file",action:e.qiniuZone,"on-remove":e.iconRemove,"before-remove":e.beforeIconRemove,"file-list":e.fileList2,data:e.picData,"on-success":e.handleUploadIconSuccess,"before-upload":e.getQiniuToken}},[e.infoForm.icon_url?e._e():o("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1),o("div",{staticClass:"form-tip"},[e._v(" 图片尺寸：图标250*250, 只能上传jpg/png文件 ")])],1):e._e(),o("el-form-item",{attrs:{label:"排序"}},[o("el-input-number",{attrs:{min:1,max:1e3},model:{value:e.infoForm.sort_order,callback:function(t){e.$set(e.infoForm,"sort_order",t)},expression:"infoForm.sort_order"}})],1),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.onSubmitInfo}},[e._v("确定保存")]),o("el-button",{on:{click:e.goBackPage}},[e._v("取消")])],1)],1)],1)])])},n=[],i=(o("99af"),o("14d9"),o("a3be")),a={data:function(){return{root:"",qiniuZone:"",fileList:[],fileList2:[],parentCategory:[{id:0,name:"顶级分类"}],infoForm:{id:0,name:"",parent_id:0,front_name:"",img_url:"",sort_order:100,icon_url:""},infoRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],front_name:[{required:!0,message:"请输入简介",trigger:"blur"}],img_url:[{required:!0,message:"请选择分类图片",trigger:"blur"}],icon_url:[{required:!0,message:"请选择分类图标",trigger:"blur"}]},picData:{token:""},url:""}},methods:{getQiniuToken:function(){var e=this;this.axios.post("index/getQiniuToken").then((function(t){var o=t.data.data;console.log(o),e.picData.token=o.token,e.url=o.url}))},beforeBannerRemove:function(e,t){return this.$confirm("确定移除该图？删除后将无法找回")},beforeIconRemove:function(e,t){return this.$confirm("确定移除图标？删除后将无法找回")},bannerRemove:function(e,t){var o=this;this.infoForm.img_url="";var r=this.infoForm.id;this.axios.post("category/deleteBannerImage",{id:r}).then((function(e){o.$message({type:"success",message:"删除成功"})}))},iconRemove:function(e,t){var o=this;this.infoForm.icon_url="";var r=this.infoForm.id;this.axios.post("category/deleteIconImage",{id:r}).then((function(e){o.$message({type:"success",message:"删除成功"})}))},goBackPage:function(){this.$router.go(-1)},onSubmitInfo:function(){var e=this;this.infoForm.level=0==this.infoForm.parent_id?"L1":"L2",console.log(this.infoForm.level),this.$refs["infoForm"].validate((function(t){if(!t)return!1;e.axios.post("category/store",e.infoForm).then((function(t){0===t.data.errno?(e.$message({type:"success",message:"保存成功"}),e.$router.go(-1)):e.$message({type:"error",message:"保存失败"})}))}))},handleUploadBannerSuccess:function(e,t){var o=this.url;this.infoForm.img_url=o+e.key},handleUploadIconSuccess:function(e,t){var o=this.url;this.infoForm.icon_url=o+e.key},getTopCategory:function(){var e=this;this.axios.get("category/topCategory").then((function(t){e.parentCategory=e.parentCategory.concat(t.data.data)}))},getInfo:function(){var e=this;if(this.infoForm.id<=0)return!1;var t=this;this.axios.get("category/info",{params:{id:t.infoForm.id}}).then((function(o){var r=o.data.data;console.log(r);var n={name:"分类图",url:r.img_url};e.fileList.push(n);var i={name:"图标",url:r.icon_url};e.fileList2.push(i),t.infoForm=r}))}},mounted:function(){this.getTopCategory(),this.infoForm.id=this.$route.query.id||0,this.getInfo(),this.root=i["a"].rootUrl,this.qiniuZone=i["a"].qiniu,this.getQiniuToken()}},s=a,l=(o("1af1"),o("2877")),c=Object(l["a"])(s,r,n,!1,null,"4bde0184",null);t["default"]=c.exports}}]);