(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3e060e65"],{"0615":function(e,t,s){},4678:function(e,t,s){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df48","./fa.js":"8df48","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b46","./gd.js":"f6b46","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function o(e){var t=i(e);return s(t)}function i(e){if(!s.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}o.keys=function(){return Object.keys(a)},o.resolve=i,e.exports=o,o.id="4678"},"480b":function(e,t,s){"use strict";s("0615")},"857a":function(e,t,s){"use strict";var a=s("e330"),o=s("1d80"),i=s("577e"),n=/"/g,r=a("".replace);e.exports=function(e,t,s,a){var l=i(o(e)),c="<"+t;return""!==s&&(c+=" "+s+'="'+r(i(a),n,"&quot;")+'"'),c+">"+l+"</"+t+">"}},"96ef":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"content-page"},[s("div",{staticClass:"content-nav"},[s("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[s("el-breadcrumb-item",{attrs:{to:{name:"ad"}}},[e._v("广告列表")]),s("el-breadcrumb-item",[e._v(e._s(e.infoForm.id?"编辑广告":"添加广告"))])],1),s("div",{staticClass:"operation-nav"},[s("el-button",{attrs:{type:"primary",icon:"arrow-left"},on:{click:e.goBackPage}},[e._v("返回列表")])],1)],1),s("div",{staticClass:"content-main"},[s("div",{staticClass:"form-table-box"},[s("el-form",{ref:"infoForm",attrs:{rules:e.infoRules,model:e.infoForm,"label-width":"120px"}},[e.infoForm.image_url?s("el-form-item",{staticClass:"image-uploader-diy new-height",attrs:{label:"广告图片",prop:"image_url"}},[s("div",{staticClass:"index-image"},[e.infoForm.image_url?s("el-image",{staticClass:"image-show",attrs:{"preview-src-list":e.previewList,src:e.infoForm.image_url,fit:"cover"},on:{click:e.previewIndexImg}}):e._e(),s("div",{staticClass:"o-shadow",on:{click:e.delePicList}},[s("i",{staticClass:"el-icon-delete"})])],1)]):e._e(),e.infoForm.image_url?e._e():s("el-form-item",{attrs:{label:"广告图片",prop:"image_url"}},[s("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{name:"file",action:e.qiniuZone,"on-success":e.handleSuccess,"before-upload":e.getQiniuToken,"auto-upload":!0,"list-type":"picture-card",data:e.picData,"http-request":e.uploadIndexImg}},[s("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件")])],1)],1),s("el-form-item",{attrs:{label:"商品类型"}},[s("el-radio-group",{model:{value:e.infoForm.link_type,callback:function(t){e.$set(e.infoForm,"link_type",t)},expression:"infoForm.link_type"}},[s("el-radio",{attrs:{label:0}},[e._v("商品id")]),s("el-radio",{attrs:{label:1}},[e._v("链接")])],1)],1),1==e.infoForm.link_type?s("el-form-item",{attrs:{label:"广告链接",prop:"link"}},[s("el-input",{staticClass:"link-input",model:{value:e.infoForm.link,callback:function(t){e.$set(e.infoForm,"link",t)},expression:"infoForm.link"}})],1):e._e(),0==e.infoForm.link_type?s("el-form-item",{attrs:{label:"商品id",prop:"link"}},[s("el-input",{staticClass:"id-input",model:{value:e.infoForm.goods_id,callback:function(t){e.$set(e.infoForm,"goods_id",t)},expression:"infoForm.goods_id"}}),s("el-popover",{attrs:{placement:"right"},model:{value:e.related_pop,callback:function(t){e.related_pop=t},expression:"related_pop"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.chooseRelateGoods,stripe:""}},[s("el-table-column",{attrs:{prop:"id",label:"id",width:"100"}}),s("el-table-column",{attrs:{prop:"list_pic_url",label:"商品图片",width:"120"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("img",{staticStyle:{width:"40px",height:"40px"},attrs:{src:e.row.list_pic_url,alt:""}})]}}],null,!1,2827108702)}),s("el-table-column",{attrs:{prop:"name",label:"商品名称",width:"300px"}}),s("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(s){return e.relateSelect(t.row.id)}}},[e._v("选择 ")])]}}],null,!1,1421910715)})],1),s("el-button",{attrs:{slot:"reference",type:"primary"},on:{click:e.relateGoodsClick},slot:"reference"},[e._v("添加关联商品")])],1)],1):e._e(),s("el-form-item",{attrs:{label:"结束时间",prop:"end_time"}},[s("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期","default-time":"23:59:59"},model:{value:e.infoForm.end_time,callback:function(t){e.$set(e.infoForm,"end_time",t)},expression:"infoForm.end_time"}},[e._v(" > ")])],1),s("el-form-item",{attrs:{label:"排序",prop:"sort_order"}},[s("el-input-number",{attrs:{min:1,max:999},model:{value:e.infoForm.sort_order,callback:function(t){e.$set(e.infoForm,"sort_order",t)},expression:"infoForm.sort_order"}})],1),s("el-form-item",{attrs:{label:"广告启用"}},[s("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:e.infoForm.enabled,callback:function(t){e.$set(e.infoForm,"enabled",t)},expression:"infoForm.enabled"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.onSubmitInfo}},[e._v("确定保存")]),s("el-button",{on:{click:e.goBackPage}},[e._v("取消")])],1)],1)],1)])])},o=[],i=(s("14d9"),s("b0c0"),s("9911"),s("a3be")),n=s("6ca8"),r=s.n(n),l=s("c1df"),c=s.n(l),d={data:function(){return{qiniuZone:"",root:"",fileList:[],infoForm:{id:0,image_url:"",link_type:0,enabled:0,end_time:"",goods_id:0,link:""},infoRules:{image_url:[{required:!0,message:"请输入广告图片",trigger:"blur"}],end_time:[{required:!0,message:"请选择时间",trigger:"blur"}]},picData:{token:""},url:"",chooseRelateGoods:[],related_pop:!1,previewList:[]}},methods:{handleSuccess:function(){},previewIndexImg:function(){var e=this;e.previewList=[],e.previewList.push(e.infoForm.image_url)},delePicList:function(){var e=this;e.$confirm("确定删除该图片?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.infoForm.image_url=""})).catch((function(){}))},uploadIndexImg:function(e){var t=this,s=e.file;r()(s).then((function(e){var a={headers:{"Content-Type":"multipart/form-data"}},o=c()().format("YYYYMMDDHHmmssSSS")+Math.floor(100*Math.random())+s.name,i=new FormData;i.append("file",e.file),i.append("token",t.picData.token),i.append("key",o),t.$http.post(t.qiniuZone,i,a).then((function(e){t.handleUploadImageSuccess(e.data)}))})).catch((function(e){console.log(e)}))},handleUploadImageSuccess:function(e,t){var s=this.url;this.infoForm.image_url=s+e.key},relateSelect:function(e){console.log(e),this.infoForm.goods_id=e,this.related_pop=!1},relateGoodsClick:function(){var e=this;this.axios.post("ad/getallrelate",{id:this.infoForm.id}).then((function(t){0===t.data.errno&&(e.chooseRelateGoods=t.data.data)}))},test:function(){console.log(this.infoForm.end_time)},beforeAdRemove:function(){return this.$confirm("确定移除？")},adRemove:function(e,t){this.infoForm.image_url=""},getQiniuToken:function(){var e=this;this.axios.post("index/getQiniuToken").then((function(t){var s=t.data.data;console.log(s),e.picData.token=s.token,e.url=s.url}))},goBackPage:function(){this.$router.go(-1)},onSubmitInfo:function(){var e=this;console.log(this.infoForm);var t=this.infoForm.end_time;return 0==t?(this.$message({type:"error",message:"请选择时间"}),!1):0==this.infoForm.link_type&&0==this.infoForm.goods_id?(this.$message({type:"error",message:"请选择商品"}),!1):1==this.infoForm.link_type&&""==this.infoForm.link?(this.$message({type:"error",message:"请输入链接"}),!1):void this.$refs["infoForm"].validate((function(t){if(!t)return!1;e.axios.post("ad/store",e.infoForm).then((function(t){0===t.data.errno?(e.$message({type:"success",message:"保存成功"}),e.$router.go(-1)):100===t.data.errno?e.$message({type:"error",message:"该商品已经有广告关联"}):e.$message({type:"error",message:"保存失败"})}))}))},getInfo:function(){var e=this;if(this.infoForm.id<=0)return!1;var t=this;this.axios.get("ad/info",{params:{id:t.infoForm.id}}).then((function(s){var a=s.data.data;a.enabled=a.enabled?"1":"0",t.infoForm=a,t.infoForm.end_time=1e3*a.end_time;var o={name:a.name,url:a.image_url};e.fileList.push(o),console.log(e.infoForm)}))}},components:{},mounted:function(){this.infoForm.id=this.$route.query.id||0,this.getInfo(),this.root=i["a"].rootUrl,this.getQiniuToken(),this.qiniuZone=i["a"].qiniu}},f=d,m=(s("480b"),s("2877")),u=Object(m["a"])(f,a,o,!1,null,"69fca8eb",null);t["default"]=u.exports},9911:function(e,t,s){"use strict";var a=s("23e7"),o=s("857a"),i=s("af03");a({target:"String",proto:!0,forced:i("link")},{link:function(e){return o(this,"a","href",e)}})},af03:function(e,t,s){"use strict";var a=s("d039");e.exports=function(e){return a((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))}}}]);